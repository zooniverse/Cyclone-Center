$eye-wall-diameters = 15 30 50 80 120

km-to-px(km, scale = (318 / 600))
  deg = (km / 111.12)
  unit((deg / 0.02337) * scale, px)

@keyframes classify-loading
  0%
    background-color: rgba($blue, 0.25)

  100%
    background-color: rgba($blue, 0)

.classify
  $min-top = 40px

  display: flex
  flex-wrap: wrap
  margin-left: auto
  margin-right: auto
  position: relative
  max-width: 1200px
  
  > .interface
    width: 100%
    max-width: 700px
    margin: 0 auto
  > .guide
    width: 100%
    max-width: 920px
    margin: 0 auto
    background: #3b3b3b

  .controls
    text-align: center

    .subject
      cursor: crosshair
      overflow: hidden
      padding: 2px
      position: relative
      text-align: center

      button[name="favorite"],
      button[name="unfavorite"]
        border: 0
        bottom: 10px
        box-shadow: none
        font-size: 10px
        position: absolute
        left: 40px
        line-height: 1
        background: transparent
        border: 2px solid #fff
        color: #fff
        outline: none

        > .icon
          display: block
          font-size: 30px
          font-weight: lighter

        > .label
          display: block

        &:hover
          color: #900

      button[name="favorite"],
      button[name="unfavorite"]
        display: none

      button[name="unfavorite"] > .icon
        color: #c00

      img
        border: 2px solid transparent
        box-sizing: border-box
        display: inline-block
        height: 318px
        margin: 0 auto
        position: relative
        width: 318px
        z-index: 1
        &.older
          display: none

      svg
        z-index: 2

    button
      border: none
      border-radius: 5px;
      padding: 5px 20px

      &[name='continue']
        @extend #_CLASSIFIER_BUTTON
        background: $green
        cursor: pointer;
        width: 25%

      &:active,
      &.active
        text-shadow: none

      img
        display: block

      .swatch
        background: gray
        display: block
        height: 30px
        letter-spacing: -10em
        overflow: hidden
        text-indent: -10em
        width: 30px

        &.beige
          background: rgb(183, 153, 153)

        &.red
          background: rgb(160, 35, 35)

        &.orange
          background: rgb(255, 110, 0)

        &.yellow
          background: rgb(255, 225, 50)

        &.light-blue
          background: rgb(160, 210, 255)

        &.teal
          background: rgb(0, 191, 255)

        &.blue
          background: rgb(65, 105, 225)

        &.dark-blue
          background: rgb(0, 0, 150)

        &.white
          background: rgb(255, 255, 255)

      &[name="eye"]
        height: 50px
        width: 50px

      .circle
        background: $orange
        border: 1px solid $orange
        border-radius: 50%
        display: inline-block
        overflow: hidden
        letter-spacing: -10em
        text-indent: -10em
        vertical-align: middle

        for km in $eye-wall-diameters
          &.d{km}
            $diameter = km-to-px(km)
            height $diameter
            width $diameter
            // margin ($diameter / -2) 0 0 ($diameter / -2)

    .step-controls
      margin-bottom: 10px;
      position: relative

      button
        padding: 5px // For swatch/image buttons (the majority of buttons here)
        background: transparent;
        outline: none
        &.active
          background: $blue;

      .stronger.step button
        padding: 10px 20px
        border: 2px solid #fff
        color: #fff
        &.stronger-top-bottom
          display: none
        @media screen and (max-width: 643px) // when subject images stack vertically
          &.stronger-left-right
            display: none
          &.stronger-top-bottom
            display: inline-block

        &.active
          border-color: $blue

      .matches.step
        ul
          clearfix()
          margin: 0
          padding: 0

          li
            display: block
            float: left
            width: 20%

            button
              display: block
              font-size: 12px
              font-weight: bold
              line-height: 1
              width: 100%

        .categories
          ul
            li
              text-align: center
            button
              @extend #_CLASSIFIER_BUTTON
              width: 90%

              &.active
                background: $blue
                border-left-color: #bbb
                color: inherit

                &:after
                  border: 15px solid transparent
                  border-bottom: 0
                  border-top-color: $blue
                  content: ""
                  height: 0
                  left: 50%
                  margin: -7px 0 0 -15px
                  position: absolute
                  top: 100%
                  width: 0

        [data-category]
          display: none
          padding: 5px

          &.active
            display: block

          button
            border: 5px solid transparent
            box-shadow: none
            padding: 0
            position: relative
            outline: none
            &.active
              border-color: $blue
              border-radius: 5px

            img
              display: block
              max-width: 100%

            .caption
              background: rgba(#fff, 0.75)
              bottom: 10px
              left: 10px
              position: absolute
              right: 10px
              text-align: center

    .progress
      .in-progress
        padding: 10px

      .followup
        display: none
        overflow: hidden
        padding: 20px;

        .talk
        .social
          width: 30%

          a
            border: 0
            color: inherit
            display: block
            font-size: 12px
            margin: 5px
            padding: 3px 10px
            text-decoration: underline

            &:hover
              color: inherit

        .talk
          float: left

        .social
          float: right

        button[name="next"]
          @extend #_CLASSIFIER_BUTTON
          background: $blue
          margin-top: 15px
          width: 25%

  &.loading .controls .subject
    animation: 1s classify-loading ease-in-out infinite alternate

  // The "stronger" step gets side-by-side subject images.
  &[data-step="stronger"] .controls .subject img
    cursor: pointer
    float: none
    margin: 0

    &.older
      display: inline-block

    &.active
      border-color: $blue

  &[data-step="reveal"]
    .controls
      .subject
        button[name="restart"]
          display: none

        button[name="favorite"]
          display: inline-block

      .progress
        .in-progress
          display: none

        .followup
          display: block

    &.favorited .controls .subject
      button[name="favorite"]
        display: none

      button[name="unfavorite"]
        display: inline-block

    .tutorial-note
      font-size: 12px
      font-weight: bold
      letter-spacing: 1px
      text-transform: uppercase

  > p
    margin-left: 20px
    width: 640px

  .other-actions
    font-size: 12px
    font-weight: bold
    padding: 10px

    button
      background: none
      border: 0
      color: white
      cursor: pointer
      outline: none
      padding: 3px 10px

      &:hover
        text-decoration: underline

      &:first-child
        padding-left: 0

  .not-signed-in
    .sign-in,
    .sign-up
      cursor: pointer
      text-decoration: underline

  &.southern .controls button img
    -ms-filter:  "FlipH"
    filter: FlipH
    transform: scaleX(-1)

  &.signed-in .not-signed-in
    display: none

  .step-details
    box-sizing: border-box
    padding: 30px

    @media (max-width: 1000px)
      &
        position: static

    h2
      margin: 1em 0 0.2em 0

    p, li
      line-height: 1.45em

    p
      margin: 0.2em 0 1em 0

    hr
      clear: left

    table
      width: 100%

    td
      vertical-align: top
      width: 1%

      h3
        margin-top: 0

      img
        max-width: 1000%
        width: 100px

    .example
      display: block
      float: left
      margin: 0 10px 10px 0
      width: 250px

    img
      max-width: 100%

    .map,
    .graph
      box-shadow: 0 2px 4px -1px rgba(#000, 0.5)
      color: #000
      height: 360px

    .highcharts-container
      background: #fff
      margin-bottom: 40px
      padding-top: 40px
